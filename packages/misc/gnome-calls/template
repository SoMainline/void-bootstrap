# Template file for 'gnome-calls'
pkgname=gnome-calls
version=45.0
revision=1
_libcall_ui_commit=38fbc6a0fbf46dd6604865d0c5c2e4f55fa52316 # 2023-10-26
build_style=meson
# Remove need for dbus-run-session and rst2man
configure_args="-Dtests=false"
# checkdepends="dbus-run-session"
hostmakedepends="glib-devel gettext vala pkg-config wayland-devel
 evolution-data-server-devel python-docutils"
makedepends="libcallaudio-devel folks-devel libhandy1-devel libpeas-devel
 gom-devel ModemManager-devel feedbackd-devel gstreamer1-devel sofia-sip-devel
 libadwaita-devel"
depends="NetworkManager ModemManager callaudiod"
short_desc="Phone dialer and call handler"
maintainer="Jami Kettunen <jami.kettunen@somainline.org>"
license="GPL-3.0-or-later"
homepage="https://gitlab.gnome.org/GNOME/calls"
distfiles="https://gitlab.gnome.org/GNOME/calls/-/archive/v${version}.tar.gz
 https://gitlab.gnome.org/World/Phosh/libcall-ui/-/archive/${_libcall_ui_commit}.tar.gz"
checksum="7537c662371846340555e5db0d10461e1373b916a61922d7c450382f9b15e447
 3bedbb4551a95b8f2b73b1a57934e8504cc1e9c2a9b5028d31ff2ba57285ea78"
# Checking depends on a wayland session
make_check=no

LDFLAGS+="-lssl -lcrypto"

post_extract() {
	mv calls-v${version}*/* .
	mv libcall-ui-${_libcall_ui_commit}/* subprojects/libcall-ui/
}
